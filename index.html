<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>MapMyWeather - Working Demo</title>

<!-- Leaflet CSS -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  crossorigin=""
/>

<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
  }
  #map {
    height: 500px;
  }
  #weatherContainer {
    padding: 10px;
  }
  .city-weather {
    border: 1px solid #ddd;
    margin: 5px;
    padding: 10px;
    width: 200px;
  }
</style>
</head>
<body>

<h1>MapMyWeather - Working Demo</h1>
<div id="map"></div>
<div id="weatherContainer"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
  const WEATHER_API_KEY = "e110e528cbca47f7ac3104351251407";

  const cities = [
    { name: "New York", coords: [40.7128, -74.0060] },
    { name: "London", coords: [51.5074, -0.1278] },
    { name: "Tokyo", coords: [35.6762, 139.6503] },
  ];

  // Initialize map centered at lat=20, lng=0, zoom=2
  const map = L.map("map").setView([20, 0], 2);

  // Add OpenStreetMap tiles
  L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
    maxZoom: 18,
    attribution: "© OpenStreetMap contributors",
  }).addTo(map);

  // Add markers and fetch weather
  cities.forEach(city => {
    const marker = L.marker(city.coords).addTo(map);
    marker.bindPopup(city.name);

    fetchWeather(city.name);
  });

  function fetchWeather(city) {
    const url = `https://api.weatherapi.com/v1/current.json?key=${WEATHER_API_KEY}&q=${encodeURIComponent(city)}`;

    fetch(url)
      .then(res => {
        if (!res.ok) throw new Error("City not found");
        return res.json();
      })
      .then(data => {
        displayCityWeather(data);
      })
      .catch(err => {
        console.error("Error fetching weather for", city, err);
      });
  }

  function displayCityWeather(data) {
    const container = document.getElementById("weatherContainer");

    const div = document.createElement("div");
    div.className = "city-weather";

    div.innerHTML = `
      <h3>${data.location.name}</h3>
      <p>Temp: ${data.current.temp_c}°C</p>
      <p>Condition: ${data.current.condition.text}</p>
      <p>Humidity: ${data.current.humidity}%</p>
      <p>Wind: ${data.current.wind_kph} km/h</p>
    `;

    container.appendChild(div);
  }
</script>

</body>
</html>
